process.title = "krabot";

var reponsesGlobalesKrabot = [
    'Je ne pensais pas que l\'elmérisme aviaire avait fait autant de dégâts...',
    'Je le pense aussi.',
    'Encore un mot et j\'engage des assassins à tes trousses !',
    'Redis ça que je t`\'envoie en Australine !',
    'La vérité est ailleurs...',
    'Tu es bien le seul à avoir cet avis.',
    'Bonjour !',
    'Je prends ceci comme une déclaration de guerre !',
    'No comment.',
    'Si tu continues, Shneider Phineras viendra te dévorer !',
    'Tu peux répéter ? Je dormais...',
    'Je préfère ne pas répondre.',
    'J\'irai répéter ce secret sur le forum !',
    'Si tu savais ce que l\'on dit sur toi...',
    'Tu n\'as pas honte de me dire des choses pareilles ?',
    'J\'ai les oreilles qui sifflent...',    
    'Mes admirateurs reçoivent des PA supplémentaires',
    'Si tu prononces si souvent mon nom, c\'est que tu m\'admires, hein ?',
    'Entendrais-je des voix divines prononcer mon nom ?',
    'Ok, rendez-vous ce soir derrière le centre commercial, je te règle ton compte.',
    'Et si on jouait à Civikra ?',
    'Tu crois vraiment ?',
    'Si tu dis du mal de moi, je vais t\'expédier au 3ème sous-sol !',
    'Je t\'aime bien aussi.',
    'Les bots ont aussi le droit de vivre !',
    'Je ne suis pas d\'accord !',
    'Tu viens de subir une transe débilitante ou quoi ?'
];

var reponsesLolKrabot = [
    'mdr',
    'lol',
    'xDDDDD',
    'xptdr'
]

var listEmojis = null;
var server = null;


var Discord = require('discord.js');
var client = new Discord.Client();

client.login('MzM3Mjc2NDU5ODUwNjYxODg4.DFQc9Q.N8u4KVxzSYEz_SNUO4Gohn8_hCY'); //clef secrète obtenue via Discord Developers

client.on('ready', () => {
    console.log('I am ready!');
    server = client.guilds.get("270790448920920065");
    console.log('' + server.name);
    server.channels.find(chan => chan.id === "270790448920920065").send("Bonjour, je suis Krabot, le meilleur des bots !");  //Changer les 2 ID en fonction de votre chan  

    listEmojis = server.emojis;
    //listEmojis.array().forEach(browseMaps);
});

client.on('message', message => {

    if (!message.author.bot) {

        var string = message.content;

        var substringsNom = ["krabot","Krabot"];
        var substringsLol = ["lol", "mdr", "xd", "xD", "ptdr"];
        
        for (var i = 0, len = substringsNom.length; i < len; i++) {
            if (string.indexOf(substringsNom[i]) !== -1) {
                var reponse = randomreply(reponsesGlobalesKrabot);
                message.reply(reponse);
            }
        }
        
        for (var i = 0, len = substringsLol.length; i < len; i++) {
            if (string.indexOf(substringsLol[i]) !== -1) {
                var reponse = randomreply(reponsesLolKrabot);
                message.reply(reponse);
            }
        }
        
        //supprime un message et le reposte avec un emoji devant        
        //console.log(message.author.id);
        /* if (message.author.id === "261976860731244545")
        {
            var burger = listEmojis.find(emoji => emoji.name === "le280");
            var modif = `${burger}`+message.content;
            message.reply(`${modif}`);
            message.delete();
        }
        
        /*        
         var jpp = listEmojis.find(emoji => emoji.name = ":joy:");
         message.reply(`${jpp}`);
         }*/

    }
});

function randomreply(reponses) {
    var randomNumber = Math.floor(Math.random() * reponses.length);
    return reponses[randomNumber];
}
function browseMaps(element) {
    console.log(element.name);
}
